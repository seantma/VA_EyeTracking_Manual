<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>VA Scanner Eye-Tracking User&#39;s Manual</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>





</head>

<body>
<h1>VA Scanner Eye-Tracking User&#39;s Manual</h1>

<p>ver. 0.2 (<em>Prepared by Evan Gennrich &amp; Sean Ma. Questions or suggestions please address to Sean Ma</em>: <strong><a href="mailto:tehsheng@umich.edu">tehsheng@umich.edu</a></strong>) </p>

<h2>1. Hardware Specs</h2>

<h3>Nordic Neuro Lab EyeTracking Camera</h3>

<p>The EyeTracking Camera System consists of three components:</p>

<ol>
<li><p>EyeTracking Camera: an MR-compatible camera that can be connected to the software for capturing video of the subject&#39;s eye.</p></li>
<li><p>Shielded Interface Unit: A Unit that contains control electronics for the EyeTracking Camera and a Fiber Transmitter.</p></li>
<li><p>Fiber Receiver: Converts the optical signal coming from the magnet room into an electrical composite video signal.</p></li>
</ol>

<h2>2. Software Specs</h2>

<h3>Arrington ViewPoint EyeTracker</h3>

<p>Description: The ViewPoint EyeTracker provides a complete eye movement evaluation environment including intergrated stimulus presentation, simultaneous eye movement and pupil diameter monitoring, and a Software Developer&#39;s Kit (SDK) for communicating with other applications. It incorporates several methods from which the user can select to optimize the system for a particular application. It provides several methods of mapping poition signals extracted from the segmented video image in EyeSpace coordinates to the participant&#39;s point of regard in GazeSpace. </p>

<h2>3. Starting the eye-tracking software</h2>

<ol>
<li><p>Turn on the eyetracking computer (computer to the right).</p></li>
<li><p>Login &#39;fMRI User&#39; on the login page.</p></li>
<li><p>Ensure that the computer resolution is 800x600. If not, go to Control Panel &gt;&gt; Display Setting &gt;&gt; Settings &gt;&gt; ScreenResolution Scrollbar &gt;&gt; 800x600</p></li>
<li><p>On Desktop upper left corner, click on <strong>&ldquo;Shortcut to ViewPoint&rdquo;</strong> icon to start the eye-tracking software.</p></li>
<li><p>Below shows the <strong>default</strong> Viewpoint software window after it&#39;s opened (<em><strong>Note: Due to screen resolution at 800x600, portions of the software are not shown</strong></em>). The 3 crucial windows for general eye-tracking purpose will be: </p>

<ul>
<li><em><strong>EyeCamera</strong></em></li>
<li><em><strong>EyeSpace</strong></em></li>
<li><em><strong>GazeSpace</strong></em></li>
</ul>

<p><img src="figure_VA_Manual/Default_Highlight_EyeGaze.png" alt="alt text"/></p></li>
</ol>

<h2>4. Calibrating eye space with stimulus space</h2>

<p>In order to establish a relationship between what the eye is seeing (<strong>eye space</strong>) onto the presented stimulus (<strong>stimulus space</strong>), calibration is needed. Below are the steps: </p>

<ol>
<li><p>After Nita has adjusted the clarity of the goggle for the subject (close left eye, see with right eye test), switch the <strong>screen switch box</strong> knob (shown below) to <strong>&ldquo;D&rdquo;</strong> position. This will project the <strong>ViewPoint</strong> computer screen onto the goggles. </p>

<p><img src="figure_VA_Manual/SwitchBox.png" alt="alt text"/></p></li>
<li><p>Ask Nita to help on minor adjustment so that the subject&#39;s eye is fully center in the <strong>EyeCamera</strong> window. Make sure again the subject sees the whole screen clearly.</p></li>
<li><p>Drag out the <strong>EyeSpace</strong> window in ViewPoint, choose the number of calibration points you would like to use. Using 12 or 16 points is optimal. </p>

<ul>
<li>If you would like to change the color scheme of the calibration procedure, click <strong>Advanced</strong> at the bottom of the EyeSpace window. For our purposes, we use a black background and red calibration points.</li>
</ul>

<p><img src="figure_VA_Manual/ViewPointCalibrationSettings.png" alt="alt text"/></p></li>
<li><p>Instruct the subject to regarding the calibrating. Click <strong>Auto-Calibrate</strong> to start.</p>

<ul>
<li>Shown below is a successful calibration. In the <strong>EyeSpace</strong> window the green dots connected by yellow lines are the calibrated result mapped onto the 16 point calibration grid. The result is relatively rectilinear with well separated configuration of dots.</li>
</ul></li>
</ol>

<ul>
<li><p>You can recalibrate a <strong>specific point</strong> by clicking on the <strong>&ldquo;point of interest&rdquo;</strong>(highlighted white dot) and click <strong>&ldquo;Re-present&rdquo;</strong> button if the specific point is <strong>NOT</strong> aligned in the grid shape formation.</p>

<p><img src="figure_VA_Manual/ViewPointSuccessful16PointCalibration.png" alt="alt text"/></p></li>
<li><p>During the scan, the position of the subject&#39;s head might slip from the initial position. This will cause a bias shift for the eye-tracking software. It is necessary to perform a <strong>Slip Correction</strong> at this point. A slip correction takes a sample of the current position of one or more points and repositions the calibrated space accordingly.</p></li>
</ul>

<h2>5. Collecting eye data in E-prime</h2>

<p>ViewPoint is constantly logging eye data, including gaze position and pupil size, in its data stream output. To markup task related time entries, the goal is to insert a marker into ViewPoint&#39;s data stream before and after the task stimulus is presented to the subject. This will allow user&#39;s to capture meaningful task related data for later analysis.</p>

<p>To begin, copy the following the code into your EPrime task: (<em><strong>Note: this code serves as a communication glue between E-prime and Viewpoint</strong></em>)</p>

<pre><code>#Insert into E-Prime task script
Declare Function vpxs_SendCommandString Lib &quot;C:/Documents and Settings/fMRI User/My Documents/ViewPoint2.8.6.21/Interfaces/Windows/ViewPointClient_Ethernet_Interface/VPX_InterApp.dll&quot; Alias &quot;vpxs_SendCommandString&quot; (ByVal lpcmd as String) As Integer

Dim vpxresult As Integer
Dim vpxver As Integer
</code></pre>

<p>Create two additional scripts in E-prime from below. Place them before and after the stimulus shown in the example below.</p>

<pre><code>#Insert as inline object before stimulus presentation
vpxver=vpxs_SendCommandString(&quot;dataFile_InsertMarker O&quot;)
</code></pre>

<pre><code>#Insert as inline object after stimulus presentation
vpxver=vpxs_SendCommandString(&quot;dataFile_InsertMarker X&quot;)
</code></pre>

<ul>
<li><img src="figure_VA_Manual/Eprimesynccode.png" alt="alt text"/></li>
</ul>

<h2>6. Collecting eye data in ViewPoint with E-prime synchronization</h2>

<p>This saves the data stream into a file in ViewPoint and initiates the communication between E-prime and ViewPoint so that markers can be embedded into the ViewPoint data stream precisely.</p>

<ol>
<li><p>In ViewPoint, click <strong>&ldquo;File &gt; Data &gt; New Data File&rdquo;</strong>. Type in the filename to save and make sure to change the <strong>&ldquo;Save as type</strong> into <strong>&quot;Tab Delimited Text (*.txt)&rdquo;</strong>. This will start saving the data stream into the text file.</p></li>
<li><p>On the E-prime computer, click the icon <strong>&ldquo;Shortcut to ViewPointClient&rdquo;</strong> located in the upper right corner of the desktop. The following window will be displayed:</p>

<p><img src="figure_VA_Manual/clientexe.png" alt="alt text"/></p></li>
<li><p>Make sure the IP address is <strong>192.168.1.151</strong> (this should not change, but if so, verify the <strong>&ldquo;Status Window&rdquo;</strong> in <strong>ViewPoint</strong> shown below to confirm the ip address matches). Click the <strong>&ldquo;Attach Server&rdquo;</strong> button to start synchronization between the two computers and remember to click the <strong>&ldquo;Detach&rdquo;</strong> button after data collection is done. </p></li>
</ol>

<ul>
<li><p>If the <strong>Data</strong> field is 0, or remains constant, check to see that Viewpoint isn&#39;t in Freeze mode by clicking the menu: <strong>Interface &gt; Send Data &gt; Streaming Data</strong></p>

<p><img src="figure_VA_Manual/Default_Highlight_IP.png" alt="alt text"/></p></li>
</ul>

</body>

</html>

